if(typeof CCrm=="undefined")CCrm={};CCrm.JSCore={RetrieveRequest:function(e,c){var d="/"+c+"(guid'"+e+"')",a=CCrm.JSCore.getHTTPRequest(),b;if(a!=false){a.open("GET",CCrm.JSCore.getRESTUrl()+d,false);a.setRequestHeader("Accept","application/json");a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.onreadystatechange=function(){b=CCrm.JSCore.RetrievedReqCallBack(this)};a.send()}return b},RetrievedReqCallBack:function(a){if(a.readyState==4)if(a.status==200)return JSON.parse(a.responseText).d;else CCrm.JSCore.errorHandler(a)},UpdateRequest:function(f,e,c){var a=CCrm.JSCore.getHTTPRequest(),d="/"+c+"(guid'"+f+"')",b;if(a!=false){a.open("POST",CCrm.JSCore.getRESTUrl()+d,false);a.setRequestHeader("Accept","application/json");a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.setRequestHeader("X-HTTP-Method","MERGE");a.onreadystatechange=function(){b=CCrm.JSCore.updateReqCallBack(this)};a.send(JSON.stringify(e))}return b},updateReqCallBack:function(a){if(a.readyState==4)if(a.status==204||a.status==1223)return true;else CCrm.JSCore.errorHandler(a)},AssociateRequest:function(e,a,f,g,c){var b={};b.uri=CCrm.JSCore.getRESTUrl()+"/"+a+"(guid'"+f+"')";var d=window.JSON.stringify(b);return CCrm.JSCore.AssociateReqCallBack({type:"POST",url:CCrm.JSCore.getRESTUrl()+"/"+a+"(guid'"+e+"')/$links/"+c,data:d})},AssociateReqCallBack:function(b){var a=CCrm.JSCore.getHTTPRequest();a.open(b.type,b.url,false);a.setRequestHeader("Accept","application/json");b.action!=null&&a.setRequestHeader("X-HTTP-Method",b.action);a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.onreadystatechange=function(){if(this.readyState==4)return this.status==204||this.status==1223||this.status==201?true:false};if(typeof b.data==="undefined")a.send();else a.send(b.data)},CreateRequest:function(d,c){var f="/"+c,e=window.JSON.stringify(d),a=CCrm.JSCore.getHTTPRequest(),b;if(a!=false){a.open("POST",CCrm.JSCore.getRESTUrl()+f,false);a.setRequestHeader("Accept","application/json");a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.onreadystatechange=function(){b=CCrm.JSCore.createReqCallBack(this)};a.send(e)}return b},createReqCallBack:function(a){if(a.readyState==4)if(a.status==201)return JSON.parse(a.responseText).d;else CCrm.JSCore.errorHandler(a)},DeleteRequest:function(e,c){var d="/"+c+"(guid'"+e+"')",a=CCrm.JSCore.getHTTPRequest(),b;if(a!=false){a.open("POST",CCrm.JSCore.getRESTUrl()+d,false);a.setRequestHeader("Accept","application/json");a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.setRequestHeader("X-HTTP-Method","DELETE");a.onreadystatechange=function(){b=CCrm.JSCore.deleteReqCallBack(this)};a.send()}return b},deleteReqCallBack:function(a){if(a.readyState==4)if(a.status==204||a.status==1223)return true;else CCrm.JSCore.errorHandler(a)},DisassociateRequest:function(g,f,c,d){var e="/"+d+"(guid'"+g+"')/$links/"+c+"(guid'"+f+" ')",a=CCrm.JSCore.getHTTPRequest(),b;if(a!=false){a.open("POST",CCrm.JSCore.getRESTUrl()+e,false);a.setRequestHeader("Accept","application/json");a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.setRequestHeader("X-HTTP-Method","DELETE");a.onreadystatechange=function(){b=CCrm.JSCore.disassociateReqCallBack(this)};a.send()}return b},disassociateReqCallBack:function(a){if(a.readyState==4)if(a.status==204||a.status==1223)return true;else CCrm.JSCore.errorHandler(a)},RetrieveAssociatedRequest:function(f,c,d){var e="/"+d+"(guid'"+f+"')/"+c,a=CCrm.JSCore.getHTTPRequest(),b;if(a!=false){a.open("GET",CCrm.JSCore.getRESTUrl()+e,false);a.setRequestHeader("Accept","application/json");a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.onreadystatechange=function(){b=CCrm.JSCore.retrieveassociateReqCallBack(this)};a.send()}return b},retrieveassociateReqCallBack:function(a){if(a.readyState==4)if(a.status==200)return JSON.parse(a.responseText).d;else CCrm.JSCore.errorHandler(a)},RetrieveMultipleRequest:function(c){var a=CCrm.JSCore.getHTTPRequest(),b;if(a!=false){a.open("GET",CCrm.JSCore.getRESTUrl()+c,false);a.setRequestHeader("Accept","application/json");a.setRequestHeader("Content-Type","application/json; charset=utf-8");a.onreadystatechange=function(){b=CCrm.JSCore.RetrievedMultipleReqCallBack(this)};a.send()}return b},RetrievedMultipleReqCallBack:function(a){if(a.readyState==4)if(a.status==200)return JSON.parse(a.responseText).d;else CCrm.JSCore.errorHandler(a)},getHTTPRequest:function(){var a;if(typeof XMLHttpRequest!="undefined")try{a=new XMLHttpRequest}catch(c){a=false}if(!a)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){a=false}}if(!a&&window.createRequest)try{a=window.createRequest()}catch(c){a=false}return a},getRESTUrl:function(){var b="/XRMServices/2011/organizationdata.svc",a="";if(typeof GetGlobalContext=="function"){var c=GetGlobalContext();a=c.getServerUrl()}else if(typeof Xrm.Page.context=="object")a=Xrm.Page.context.getServerUrl();else throw new Error("Unable to access the server URL");if(a.match(/\/$/))a=a.substring(0,a.length-1);return a+b},errorHandler:function(a){var b="Unable to parse error message";try{b=JSON.parse(a.responseText).error.message.value}catch(c){}alert("Error : "+a.status+": "+a.statusText+": "+b)}}