<?xml version="1.0" encoding="utf-8"?>
<RibbonDiffXml>
  <CustomActions>
    <CustomAction Id="ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Save.Controls._children" Sequence="61">
      <CommandUIDefinition>
        <Button Alt="$LocLabels:ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.Alt" Command="Mscrm.Jewel.FormProperties" Description="Properties" Id="ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button" Image16by16="/_imgs/FormEditorRibbon/Properties_16.png" LabelText="$LocLabels:ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.LabelText" Sequence="61" TemplateAlias="o1" ToolTipTitle="$LocLabels:ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.ToolTipTitle" ToolTipDescription="$LocLabels:ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.ToolTipDescription" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="ccrm.ccrm_opportunityapproval.Button1.Button.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Save.Controls._children" Sequence="59">
      <CommandUIDefinition>
        <Button Alt="$LocLabels:ccrm.ccrm_opportunityapproval.Button1.Button.Alt" Command="ccrm.ccrm_opportunityapproval.Command1.Command" Description="Approve" Id="ccrm.ccrm_opportunityapproval.Button1.Button" Image32by32="$webresource:ccrm_greentick_32x32" Image16by16="$webresource:ccrm_greentick_16x16" LabelText="$LocLabels:ccrm.ccrm_opportunityapproval.Button1.Button.LabelText" Sequence="59" TemplateAlias="o1" ToolTipTitle="$LocLabels:ccrm.ccrm_opportunityapproval.Button1.Button.ToolTipTitle" ToolTipDescription="$LocLabels:ccrm.ccrm_opportunityapproval.Button1.Button.ToolTipDescription" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="ccrm.ccrm_opportunityapproval.Button2.Button.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Save.Controls._children" Sequence="60">
      <CommandUIDefinition>
        <Button Alt="$LocLabels:ccrm.ccrm_opportunityapproval.Button2.Button.Alt" Command="ccrm.ccrm_opportunityapproval.Command2.Command" Description="Decline" Id="ccrm.ccrm_opportunityapproval.Button2.Button" Image32by32="$webresource:ccrm_redcross_32x32" Image16by16="$webresource:ccrm_redcross_16x16" LabelText="$LocLabels:ccrm.ccrm_opportunityapproval.Button2.Button.LabelText" Sequence="60" TemplateAlias="o1" ToolTipTitle="$LocLabels:ccrm.ccrm_opportunityapproval.Button2.Button.ToolTipTitle" ToolTipDescription="$LocLabels:ccrm.ccrm_opportunityapproval.Button2.Button.ToolTipDescription" />
      </CommandUIDefinition>
    </CustomAction>
    <HideCustomAction HideActionId="ccrm.dev1.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.Hide" Location="dev1.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.ccrm_opportunityapproval.AddToQueue.Hide" Location="Mscrm.Form.ccrm_opportunityapproval.AddToQueue" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.ccrm_opportunityapproval.Convert.Case.Hide" Location="Mscrm.Form.ccrm_opportunityapproval.Convert.Case" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.ccrm_opportunityapproval.Convert.Opportunity.Hide" Location="Mscrm.Form.ccrm_opportunityapproval.Convert.Opportunity" />
    <CustomAction Id="ccrm.Mscrm.Form.ccrm_opportunityapproval.Deactivate.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Save.Controls._children" Sequence="65">
      <CommandUIDefinition>
        <Button Alt="$Resources:Ribbon.HomepageGrid.account.Record.Status.Deactivate" Command="Mscrm.Form.Deactivate" Id="Mscrm.Form.ccrm_opportunityapproval.Deactivate" Image32by32="/_imgs/ribbon/Deactivate_32.png" Image16by16="/_imgs/ribbon/Deactivate_16.png" LabelText="$Resources:Ribbon.HomepageGrid.account.Record.Status.Deactivate" Sequence="65" TemplateAlias="o2" ToolTipTitle="$Resources:Ribbon.HomepageGrid.account.Record.Status.Deactivate" ToolTipDescription="$Resources(EntityPluralDisplayName):Ribbon.Tooltip.Deactivate" ModernImage="DeActivate" />
      </CommandUIDefinition>
    </CustomAction>
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.ccrm_opportunityapproval.Deactivate.Hide" Location="Mscrm.Form.ccrm_opportunityapproval.Deactivate" />
    <CustomAction Id="ccrm.Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Groups._children" Sequence="50">
      <CommandUIDefinition>
        <Group Command="Mscrm.Enabled" Description="$Resources:MenuItem_Label_Convert_Entity_Mask" Id="Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert" Image32by32Popup="/_imgs/ribbon/ConvertOpportunity_32.png" Sequence="50" Template="Mscrm.Templates.Flexible2" Title="$Resources:MenuItem_Label_Convert_Entity_Mask">
          <Controls Id="Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert.Controls">
            <Button Alt="$Resources:MenuItem_ToolTip_ConvertToOpportunity" Command="Mscrm.Form.ConvertToOpportunity" Id="Mscrm.Form.ccrm_opportunityapproval.Convert.Opportunity" Image32by32="/_imgs/ribbon/ConvertOpportunity_32.png" Image16by16="/_imgs/ribbon/ConvertOpportunity_16.png" LabelText="$Resources:MenuItem_Label_ConvertToOpportunity" Sequence="10" TemplateAlias="o1" ToolTipTitle="$Resources:Mscrm_Form_Other_MainTab_Actions_Convert_Opportunity_ToolTipTitle" ToolTipDescription="$Resources:Mscrm_Form_Other_MainTab_Actions_Convert_Opportunity_ToolTipDescription" ModernImage="Opportunity" />
            <Button Alt="$Resources:MenuItem_ToolTip_ConvertToCase" Command="Mscrm.Form.ConvertToCase" Id="Mscrm.Form.ccrm_opportunityapproval.Convert.Case" Image32by32="/_imgs/ribbon/ConvertCase_32.png" Image16by16="/_imgs/ribbon/ConvertCase_16.png" LabelText="$Resources:MenuItem_Label_ConvertToCase" Sequence="20" TemplateAlias="o2" ToolTipTitle="$Resources:Mscrm_Form_Other_MainTab_Actions_Convert_Case_ToolTipTitle" ToolTipDescription="$Resources:Mscrm_Form_Other_MainTab_Actions_Convert_Case_ToolTipDescription" />
            <Button Alt="$Resources:MenuItem_Label_PromoteToResponse" Command="Mscrm.PromoteToResponse" Id="Mscrm.Form.ccrm_opportunityapproval.PromoteToResponse" Image32by32="/_imgs/Workplace/ConvertActivity_32.png" Image16by16="/_imgs/Workplace/ConvertActivity_16.png" LabelText="$Resources:MenuItem_Label_PromoteToResponse" Sequence="30" TemplateAlias="o2" ToolTipTitle="$Resources:MenuItem_Label_PromoteToResponse" ToolTipDescription="$Resources:MenuItem_Tooltip_Description_PromoteToResponse" />
          </Controls>
        </Group>
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="ccrm.Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert.MaxSize.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Scaling._children" Sequence="41">
      <CommandUIDefinition>
        <MaxSize GroupId="Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert" Id="Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert.MaxSize" Sequence="41" Size="LargeMedium" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="ccrm.Mscrm.Form.ccrm_opportunityapproval.MainTab.ConvertGroup.Scale.1.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Scaling._children" Sequence="99">
      <CommandUIDefinition>
        <Scale GroupId="Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert" Id="Mscrm.Form.ccrm_opportunityapproval.MainTab.ConvertGroup.Scale.1" Sequence="99" Size="LargeSmall" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="ccrm.Mscrm.Form.ccrm_opportunityapproval.MainTab.ConvertGroup.Scale.2.CustomAction" Location="Mscrm.Form.ccrm_opportunityapproval.MainTab.Scaling._children" Sequence="113">
      <CommandUIDefinition>
        <Scale GroupId="Mscrm.Form.ccrm_opportunityapproval.MainTab.Convert" Id="Mscrm.Form.ccrm_opportunityapproval.MainTab.ConvertGroup.Scale.2" Sequence="113" Size="Popup" />
      </CommandUIDefinition>
    </CustomAction>
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.ccrm_opportunityapproval.NewRecord.Hide" Location="Mscrm.Form.ccrm_opportunityapproval.NewRecord" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.ccrm_opportunityapproval.PromoteToResponse.Hide" Location="Mscrm.Form.ccrm_opportunityapproval.PromoteToResponse" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.ccrm_opportunityapproval.QueueItemDetail.Hide" Location="Mscrm.Form.ccrm_opportunityapproval.QueueItemDetail" />
    <HideCustomAction HideActionId="Mscrm.SubGrid.ccrm_opportunityapproval.AddExistingAssoc.HideAction" Location="Mscrm.SubGrid.ccrm_opportunityapproval.AddExistingAssoc" />
  </CustomActions>
  <Templates>
    <RibbonTemplates Id="Mscrm.Templates"></RibbonTemplates>
  </Templates>
  <CommandDefinitions>
    <CommandDefinition Id="ccrm.ccrm_opportunityapproval.Command1.Command">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction FunctionName="buttonApprove" Library="$webresource:Ccrm_opportunityapproval_main_library.js" />
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="ccrm.ccrm_opportunityapproval.Command2.Command">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction FunctionName="buttonDecline" Library="$webresource:Ccrm_opportunityapproval_main_library.js" />
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.Form.Activate">
      <EnableRules>
        <EnableRule Id="Mscrm.CanWritePrimary" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.CanWritePrimary" />
        <DisplayRule Id="Mscrm.PrimaryIsInactive" />
        <DisplayRule Id="Mscrm.PrimaryEntityHasStatecode" />
        <DisplayRule Id="Mscrm.PrimaryIsNotActivity" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Activate.activatePrimaryRecord" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="FirstPrimaryItemId" />
          <CrmParameter Value="PrimaryEntityTypeName" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.Form.Deactivate">
      <EnableRules>
        <EnableRule Id="Mscrm.CanWritePrimary" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.CanWritePrimary" />
        <DisplayRule Id="Mscrm.PrimaryIsActive" />
        <DisplayRule Id="Mscrm.PrimaryEntityHasStatecode" />
        <DisplayRule Id="Mscrm.PrimaryIsNotActivity" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Deactivate.deactivatePrimaryRecord" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="FirstPrimaryItemId" />
          <CrmParameter Value="PrimaryEntityTypeName" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.Jewel.FormProperties">
      <EnableRules>
        <EnableRule Id="Mscrm.FormStateNotNew" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.AvailableOnForm" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="Mscrm.RibbonActions.openFormProperties" Library="/_static/_common/scripts/RibbonActions.js">
          <CrmParameter Value="FirstPrimaryItemId" />
          <CrmParameter Value="PrimaryEntityTypeCode" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
  </CommandDefinitions>
  <RuleDefinitions>
    <TabDisplayRules />
    <DisplayRules>
      <DisplayRule Id="Mscrm.AvailableOnForm">
        <EntityRule AppliesTo="PrimaryEntity" Context="Form" Default="false" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.CanWritePrimary">
        <EntityPrivilegeRule PrivilegeType="Write" PrivilegeDepth="Basic" AppliesTo="PrimaryEntity" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.PrimaryEntityHasStatecode">
        <EntityPropertyRule AppliesTo="PrimaryEntity" PropertyName="HasStateCode" PropertyValue="true" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.PrimaryIsActive">
        <FormStateRule State="Existing" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.PrimaryIsInactive">
        <FormStateRule State="Disabled" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.PrimaryIsNotActivity">
        <EntityPropertyRule AppliesTo="PrimaryEntity" PropertyName="IsActivity" PropertyValue="false" />
      </DisplayRule>
    </DisplayRules>
    <EnableRules>
      <EnableRule Id="Mscrm.CanWritePrimary">
        <RecordPrivilegeRule PrivilegeType="Write" AppliesTo="PrimaryEntity" />
      </EnableRule>
      <EnableRule Id="Mscrm.FormStateNotNew">
        <FormStateRule State="Create" InvertResult="true" />
      </EnableRule>
    </EnableRules>
  </RuleDefinitions>
  <LocLabels>
    <LocLabel Id="ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.Alt">
      <Titles>
        <Title description="Properties" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.LabelText">
      <Titles>
        <Title description="Properties" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.ToolTipDescription">
      <Titles>
        <Title description="Properties" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ApplicationRibbon.ccrm_opportunityapproval.ShowProperties.Button.ToolTipTitle">
      <Titles>
        <Title description="Properties" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button1.Button.Alt">
      <Titles>
        <Title description="Approve" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button1.Button.LabelText">
      <Titles>
        <Title description="Approve" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button1.Button.ToolTipDescription">
      <Titles>
        <Title description="CRM will automatically close the window" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button1.Button.ToolTipTitle">
      <Titles>
        <Title description="When approving this record you can move the opportunity to the next stage or if you are at the CJN stage CRM will automatically generate the next approvals or if this is a financial approval CRM will close the opportunity automatically and generate the CJN number" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button2.Button.Alt">
      <Titles>
        <Title description="Decline" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button2.Button.LabelText">
      <Titles>
        <Title description="Decline" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button2.Button.ToolTipDescription">
      <Titles>
        <Title description="CRM will automatically close the window" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.ccrm_opportunityapproval.Button2.Button.ToolTipTitle">
      <Titles>
        <Title description="Declines the current Review and Approval record" languagecode="1033" />
      </Titles>
    </LocLabel>
  </LocLabels>
</RibbonDiffXml>