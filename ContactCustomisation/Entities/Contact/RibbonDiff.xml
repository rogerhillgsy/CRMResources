<?xml version="1.0" encoding="utf-8"?>
<RibbonDiffXml>
  <CustomActions>
    <CustomAction Id="arup.ccrm.contact.Button2.Button.CustomAction" Location="Mscrm.Form.contact.MainTab.Collaborate.Controls._children" Sequence="20">
      <CommandUIDefinition>
        <Button Alt="$LocLabels:ccrm.contact.Button2.Button.Alt" Command="ccrm.contact.OutlookSync.Command" Description="Click here to Connect to this Contact and synchronise this Contact's details to Outlook" Id="ccrm.contact.Button2.Button" Image32by32="$webresource:ccrm_outlook32x32" LabelText="$LocLabels:ccrm.contact.Button2.Button.LabelText" Sequence="20" TemplateAlias="o1" ToolTipTitle="$LocLabels:ccrm.contact.Button2.Button.ToolTipTitle" ToolTipDescription="$LocLabels:ccrm.contact.Button2.Button.ToolTipDescription" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="arup.ccrm.contact.Exit.Button.CustomAction" Location="Mscrm.Form.contact.MainTab.Save.Controls._children" Sequence="15">
      <CommandUIDefinition>
        <Button Alt="$LocLabels:ccrm.contact.Exit.Button.Alt" Command="ccrm.contact.ExitForm.Command" Id="ccrm.contact.Exit.Button" Image32by32="$webresource:ccrm_exit_door_out_32_32" Image16by16="$webresource:ccrm_exit_door_out_16_16" LabelText="$LocLabels:ccrm.contact.Exit.Button.LabelText" Sequence="15" TemplateAlias="o1" ToolTipTitle="$LocLabels:ccrm.contact.Exit.Button.ToolTipTitle" ToolTipDescription="$LocLabels:ccrm.contact.Exit.Button.ToolTipDescription" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="arup.ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.CustomAction" Location="Mscrm.HomepageGrid.contact.MainTab.Collaborate.Controls._children" Sequence="25">
      <CommandUIDefinition>
        <Button Alt="$LocLabels:ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.Alt" Command="ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.Command" Description="Click here to Connect to this Contact and synchronise this Contact's details to Outlook" Id="ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync" Image32by32="$webresource:ccrm_outlook32x32" LabelText="$LocLabels:ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.LabelText" Sequence="25" TemplateAlias="o1" ToolTipTitle="$LocLabels:ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.ToolTipTitle" ToolTipDescription="$LocLabels:ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.ToolTipDescription" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="arup.contact.Button3.Button.CustomAction" Location="Mscrm.HomepageGrid.contact.MainTab.Management.Controls._children" Sequence="80">
      <CommandUIDefinition>
        <SplitButton Command="Mscrm.SendShortcutSelected.AlwaysEnabled" Id="arup.contact.Button3.Button" Image32by32="/_imgs/ribbon/SendShortcut_32.png" Image16by16="/_imgs/ribbon/EmailLink_16.png" LabelText="$Resources:Ribbon.HomepageGrid.Record.Shortcut.Send" Sequence="80" TemplateAlias="o3" ToolTipTitle="$Resources:Ribbon.HomepageGrid.Record.Shortcut.Send" ToolTipDescription="$Resources:Mscrm_HomepageGrid_Other_MainTab_ExportData_Send_ToolTipDescription" ModernImage="EmailLink">
          <Menu Id="arup.contact.Button3.Button.Menu">
            <MenuSection Id="Mscrm.HomepageGrid.contact.Send.MenuSection" Sequence="10" DisplayMode="Menu16">
              <Controls Id="Mscrm.HomepageGrid.contact.Send.MenuSection.Controls">
                <Button Command="Mscrm.SendShortcutSelected" Id="Mscrm.HomepageGrid.contact.Send.Selected" Image32by32="/_imgs/ribbon/SendShortcut_32.png" Image16by16="/_imgs/ribbon/EmailLink_16.png" LabelText="$Resources:Ribbon.HomepageGrid.Record.Shortcut.Selected" Sequence="10" ToolTipTitle="$Resources:Ribbon.HomepageGrid.Record.Shortcut.Selected" ToolTipDescription="$Resources:Ribbon.Tooltip.SendShortcut" />
                <Button Command="Mscrm.SendShortcutView" Id="Mscrm.HomepageGrid.contact.Send.View" Image32by32="/_imgs/ribbon/SendView_32.png" Image16by16="/_imgs/ribbon/SendView_16.png" LabelText="$Resources:Ribbon.HomepageGrid.Record.Shortcut.View" Sequence="20" ToolTipTitle="$Resources:Ribbon.HomepageGrid.Record.Shortcut.View" ToolTipDescription="$Resources:Ribbon.Tooltip.SendShortcut_View" />
              </Controls>
            </MenuSection>
          </Menu>
        </SplitButton>
      </CommandUIDefinition>
    </CustomAction>
    <HideCustomAction HideActionId="arup.Mscrm.HomepageGrid.contact.MBPF.ConvertTo.Hide" Location="Mscrm.HomepageGrid.contact.MBPF.ConvertTo" />
    <HideCustomAction HideActionId="arup.Mscrm.HomepageGrid.contact.Send.Hide" Location="Mscrm.HomepageGrid.contact.Send" />
    <HideCustomAction HideActionId="arup.Mscrm.HomepageGrid.contact.SendDirectEmail.Hide" Location="Mscrm.HomepageGrid.contact.SendDirectEmail" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.AddOtherActivities.Hide" Location="Mscrm.Form.contact.AddOtherActivities" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.FollowButton.Hide" Location="Mscrm.Form.contact.FollowButton" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.NewRecord.Hide" Location="Mscrm.Form.contact.NewRecord" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.Permissions.Sharing.Hide" Location="Mscrm.Form.contact.Permissions.Sharing" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.Relationship.Hide" Location="Mscrm.Form.contact.Relationship" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.Reports.Hide" Location="Mscrm.Form.contact.Reports" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.RunScript.Hide" Location="Mscrm.Form.contact.RunScript" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.RunWorkflow.Hide" Location="Mscrm.Form.contact.RunWorkflow" />
    <HideCustomAction HideActionId="ccrm.Mscrm.Form.contact.SaveAndClose.Hide" Location="Mscrm.Form.contact.SaveAndClose" />
    <HideCustomAction HideActionId="ccrm.Mscrm.HomepageGrid.contact.NewRecord.Hide" Location="Mscrm.HomepageGrid.contact.NewRecord" />
    <HideCustomAction HideActionId="ccrm.Mscrm.SubGrid.contact.NewRecord.Hide" Location="Mscrm.SubGrid.contact.NewRecord" />
    <HideCustomAction HideActionId="ccrm.Sample.contact.MainTab.LaunchURL.Button.Hide" Location="Sample.contact.MainTab.LaunchURL.Button" />
  </CustomActions>
  <Templates>
    <RibbonTemplates Id="Mscrm.Templates"></RibbonTemplates>
  </Templates>
  <CommandDefinitions>
    <CommandDefinition Id="ccrm.contact.ExitForm.Command">
      <EnableRules />
      <DisplayRules>
        <DisplayRule Id="Mscrm.HideOnModern" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="exitForm" Library="$webresource:Contact_main_library.js">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="ccrm.contact.OutlookSync.Command">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction FunctionName="TriggerWorkflow" Library="$webresource:ccrm_TriggerSyncWorkflow" />
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.Command">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction FunctionName="launchWorkflowMulti" Library="$webresource:ccrm_script_ribbonHandler">
          <StringParameter Value="Are you sure you want to synchronise the selected records?" />
          <StringParameter Value="E64111D4-BFF6-4877-92FB-825D3658E7AE" />
          <CrmParameter Value="SelectedControlSelectedItemIds" />
          <BoolParameter Value="true" />
          <CrmParameter Value="SelectedEntityTypeCode" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.AddConnectionToMeForm">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Add.addConnectionFromForm" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="FirstPrimaryItemId" />
          <CrmParameter Value="PrimaryEntityTypeCode" />
          <CrmParameter Value="PrimaryControl" />
          <BoolParameter Value="true" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.AddNewRecordFromSubGridStandard">
      <EnableRules>
        <EnableRule Id="Mscrm.AppendToPrimary" />
        <EnableRule Id="Mscrm.EntityFormIsEnabled" />
        <EnableRule Id="Mscrm.IsEntityAvailableForUserInMocaOffline" />
        <EnableRule Id="arup.contact.AddNewRecord.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.ShowForOneToManyGrids" />
        <DisplayRule Id="Mscrm.AppendToPrimary" />
        <DisplayRule Id="Mscrm.CreateSelectedEntityPermission" />
        <DisplayRule Id="Mscrm.AppendSelected" />
        <DisplayRule Id="Mscrm.HideAddNewForChildEntities" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="Mscrm.GridCommandActions.addNewFromSubGridStandard" Library="/_static/_common/scripts/CommandBarActions.js">
          <CrmParameter Value="SelectedEntityTypeCode" />
          <CrmParameter Value="PrimaryEntityTypeCode" />
          <CrmParameter Value="FirstPrimaryItemId" />
          <CrmParameter Value="PrimaryControl" />
          <CrmParameter Value="SelectedControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.SaveAndClosePrimary">
      <EnableRules>
        <EnableRule Id="Mscrm.IsAutoSaveDisable" />
        <EnableRule Id="Mscrm.AvailableOnForm" />
        <EnableRule Id="Mscrm.CanSavePrimary" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.CanSaveAndClosePrimaryEntityType" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Save.saveAndCloseForm" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
  </CommandDefinitions>
  <RuleDefinitions>
    <TabDisplayRules />
    <DisplayRules>
      <DisplayRule Id="Mscrm.AppendSelected">
        <EntityPrivilegeRule PrivilegeType="Append" PrivilegeDepth="Basic" AppliesTo="SelectedEntity" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.AppendToPrimary">
        <EntityPrivilegeRule PrivilegeType="AppendTo" PrivilegeDepth="Basic" AppliesTo="PrimaryEntity" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.CanSaveAndClosePrimaryEntityType">
        <OrRule>
          <Or>
            <EntityPrivilegeRule PrivilegeType="Create" PrivilegeDepth="Basic" AppliesTo="PrimaryEntity" />
          </Or>
          <Or>
            <EntityPrivilegeRule PrivilegeType="Write" PrivilegeDepth="Basic" AppliesTo="PrimaryEntity" />
          </Or>
        </OrRule>
      </DisplayRule>
      <DisplayRule Id="Mscrm.CreateConnection">
        <MiscellaneousPrivilegeRule PrivilegeName="CreateConnection" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.CreateSelectedEntityPermission">
        <EntityPrivilegeRule PrivilegeType="Create" PrivilegeDepth="Basic" AppliesTo="SelectedEntity" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.HideAddNewForChildEntities">
        <OrRule>
          <Or>
            <EntityPropertyRule AppliesTo="SelectedEntity" PropertyName="IsChildEntity" PropertyValue="false" />
          </Or>
          <Or>
            <RelationshipTypeRule AppliesTo="SelectedEntity" AllowCustomRelationship="false" />
          </Or>
        </OrRule>
      </DisplayRule>
      <DisplayRule Id="Mscrm.HideOnCommandBar">
        <OrRule>
          <Or>
            <CommandClientTypeRule Type="Legacy" />
          </Or>
          <Or>
            <PageRule Address="/userdefined/edit.aspx" />
          </Or>
          <Or>
            <PageRule Address="/advancedfind/advfind.aspx" />
          </Or>
          <Or>
            <PageRule Address="/advancedfind/fetchData.aspx" />
          </Or>
          <Or>
            <PageRule Address="/tools/formeditor/formeditor.aspx" />
          </Or>
          <Or>
            <PageRule Address="/tools/visualizationdesigner/visualizationdesigner.aspx" />
          </Or>
        </OrRule>
      </DisplayRule>
      <DisplayRule Id="Mscrm.HideOnModern">
        <CommandClientTypeRule Type="Modern" InvertResult="true" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.IsConnectionsEnabledPrimary">
        <EntityPropertyRule AppliesTo="PrimaryEntity" PropertyName="IsConnectionsEnabled" PropertyValue="true" Default="false" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.ShowForOneToManyGrids">
        <RelationshipTypeRule AppliesTo="SelectedEntity" RelationshipType="OneToMany" />
      </DisplayRule>
    </DisplayRules>
    <EnableRules>
      <EnableRule Id="arup.contact.AddNewRecord.EnableRule">
        <CustomRule FunctionName="hidePlusSign" Library="$webresource:arup_hide_addnewrecord_subgrid" Default="true" InvertResult="false">
          <StringParameter Value="contact" />
        </CustomRule>
      </EnableRule>
      <EnableRule Id="Mscrm.AppendToPrimary">
        <RecordPrivilegeRule PrivilegeType="AppendTo" AppliesTo="PrimaryEntity" />
      </EnableRule>
      <EnableRule Id="Mscrm.AvailableOnForm">
        <EntityRule AppliesTo="PrimaryEntity" Context="Form" Default="false" />
      </EnableRule>
      <EnableRule Id="Mscrm.CanSavePrimary">
        <OrRule>
          <Or>
            <RecordPrivilegeRule PrivilegeType="Create" AppliesTo="PrimaryEntity" />
            <FormStateRule State="Create" />
          </Or>
          <Or>
            <RecordPrivilegeRule PrivilegeType="Write" AppliesTo="PrimaryEntity" />
            <FormStateRule State="Existing" />
          </Or>
        </OrRule>
      </EnableRule>
      <EnableRule Id="Mscrm.EntityFormIsEnabled">
        <FormStateRule State="Disabled" InvertResult="true" />
      </EnableRule>
      <EnableRule Id="Mscrm.FormStateExistingOrReadOnlyOrDisabled">
        <OrRule>
          <Or>
            <FormStateRule State="ReadOnly" />
          </Or>
          <Or>
            <FormStateRule State="Existing" />
          </Or>
          <Or>
            <FormStateRule State="Disabled" />
          </Or>
        </OrRule>
      </EnableRule>
      <EnableRule Id="Mscrm.IsAutoSaveDisable">
        <OrRule>
          <Or>
            <FormStateRule State="Create" />
          </Or>
          <Or>
            <CustomRule FunctionName="XrmCore.Rules.AutoSave.isAutoSaveEnabled" Library="$webresource:Main_system_library.js" InvertResult="true" />
          </Or>
          <Or>
            <CustomRule FunctionName="XrmCore.Rules.RefreshForm.isRefreshForm" Library="$webresource:Main_system_library.js" InvertResult="true" />
          </Or>
        </OrRule>
      </EnableRule>
      <EnableRule Id="Mscrm.IsEntityAvailableForUserInMocaOffline">
        <CustomRule FunctionName="XrmCore.Rules.Online.IsEntityAvailableForUserInMocaOffline" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedEntityTypeName" />
        </CustomRule>
      </EnableRule>
    </EnableRules>
  </RuleDefinitions>
  <LocLabels>
    <LocLabel Id="ccrm.contact.Button2.Button.Alt">
      <Titles>
        <Title description="Sync Contact to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.contact.Button2.Button.LabelText">
      <Titles>
        <Title description="Sync Contact to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.contact.Button2.Button.ToolTipDescription">
      <Titles>
        <Title description="Click here to Connect to this Contact and synchronise this Contact's details to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.contact.Button2.Button.ToolTipTitle">
      <Titles>
        <Title description="Sync Contact to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.contact.Exit.Button.Alt">
      <Titles>
        <Title description="Exit" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.contact.Exit.Button.LabelText">
      <Titles>
        <Title description="Exit" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.contact.Exit.Button.ToolTipDescription">
      <Titles>
        <Title description="Exit form" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.contact.Exit.Button.ToolTipTitle">
      <Titles>
        <Title description="Exit Contact Form" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.Alt">
      <Titles>
        <Title description="Sync Contact to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.LabelText">
      <Titles>
        <Title description="Sync Contact to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.ToolTipDescription">
      <Titles>
        <Title description="Click here to Connect to this Contact and synchronise this Contact's details to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="ccrm.HomepageGrid.contact.MainTab.Collaborate.OutlookSync.ToolTipTitle">
      <Titles>
        <Title description="Sync Contact to Outlook" languagecode="1033" />
      </Titles>
    </LocLabel>
  </LocLabels>
</RibbonDiffXml>